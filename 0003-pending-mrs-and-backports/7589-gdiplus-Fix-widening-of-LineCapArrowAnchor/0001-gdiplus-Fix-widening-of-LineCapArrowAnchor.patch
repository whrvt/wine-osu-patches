From b22d4311b4ac812349ed352a89448a57144d2b0e Mon Sep 17 00:00:00 2001
From: Bartosz Kosiorek <gang65@poczta.onet.pl>
Date: Sun, 16 Mar 2025 11:14:32 +0100
Subject: [PATCH] gdiplus: Fix widening of LineCapArrowAnchor

---
 dlls/gdiplus/graphicspath.c       |  4 ++--
 dlls/gdiplus/tests/graphicspath.c | 12 ++++++------
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/dlls/gdiplus/graphicspath.c b/dlls/gdiplus/graphicspath.c
index b1e417842f8..805068c6154 100644
--- a/dlls/gdiplus/graphicspath.c
+++ b/dlls/gdiplus/graphicspath.c
@@ -2037,8 +2037,8 @@ static void widen_cap(const GpPointF *endpoint, const GpPointF *nextpoint,
         }
         else if (cap == LineCapArrowAnchor)
         {
-            extend_dx = -3.0 * extend_dx;
-            extend_dy = -3.0 * extend_dy;
+            extend_dx = -2.0 * extend_dx;
+            extend_dy = -2.0 * extend_dy;
         }
 
         if (add_first_points)
diff --git a/dlls/gdiplus/tests/graphicspath.c b/dlls/gdiplus/tests/graphicspath.c
index 89a7dd786de..8c9c4abad06 100644
--- a/dlls/gdiplus/tests/graphicspath.c
+++ b/dlls/gdiplus/tests/graphicspath.c
@@ -1698,14 +1698,14 @@ static path_test_t widenline_capdiamondanchor_path[] = {
     };
 
 static path_test_t widenline_caparrowanchor_path[] = {
-    {15.0, 5.0,       PathPointTypeStart, 0, 1}, /*0*/
-    {40.0, 5.0,       PathPointTypeLine,  0, 1}, /*1*/
-    {40.0, 15.0,      PathPointTypeLine,  0, 1}, /*2*/
-    {15.0, 15.0,      PathPointTypeLine|PathPointTypeCloseSubpath, 0, 1}, /*3*/
-    {5.0, 10.0,       PathPointTypeStart, 0, 0}, /*4*/
+    {15.0,      5.0,  PathPointTypeStart, 0, 0}, /*0*/
+    {40.0,      5.0,  PathPointTypeLine,  0, 0}, /*1*/
+    {40.0,      15.0, PathPointTypeLine,  0, 0}, /*2*/
+    {15.0,      15.0, PathPointTypeLine|PathPointTypeCloseSubpath, 0, 0}, /*3*/
+    {5.0,       10.0, PathPointTypeStart, 0, 0}, /*4*/
     {22.320507, 0.0,  PathPointTypeLine,  0, 0}, /*5*/
     {22.320507, 20.0, PathPointTypeLine|PathPointTypeCloseSubpath, 0, 0}, /*6*/
-    {50.0, 10.0,      PathPointTypeStart, 0, 0}, /*7*/
+    {50.0,      10.0, PathPointTypeStart, 0, 0}, /*7*/
     {32.679489, 20.0, PathPointTypeLine,  0, 0}, /*8*/
     {32.679489, 0.0,  PathPointTypeLine|PathPointTypeCloseSubpath, 0, 0}, /*9*/
     };
-- 
GitLab

