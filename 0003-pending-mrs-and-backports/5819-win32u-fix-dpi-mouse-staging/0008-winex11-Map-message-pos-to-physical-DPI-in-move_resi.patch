From bb6ae2ee102a6b2fdbfd798b4916090dfe253a01 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?R=C3=A9mi=20Bernon?= <rbernon@codeweavers.com>
Date: Fri, 23 Aug 2024 08:21:03 +0200
Subject: [PATCH 8/8] winex11: Map message pos to physical DPI in
 move_resize_window.

---
 dlls/winex11.drv/mouse.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/dlls/winex11.drv/mouse.c b/dlls/winex11.drv/mouse.c
index ee0191630f7..5941eabd5d0 100644
--- a/dlls/winex11.drv/mouse.c
+++ b/dlls/winex11.drv/mouse.c
@@ -1461,7 +1461,10 @@ void move_resize_window( HWND hwnd, int dir )
     if (!(win = X11DRV_get_whole_window( hwnd ))) return;
 
     pt = NtUserGetThreadInfo()->message_pos;
-    pos = virtual_screen_to_root( (short)LOWORD( pt ), (short)HIWORD( pt ) );
+    pos.x = (short)LOWORD( pt );
+    pos.y = (short)HIWORD( pt );
+    NtUserLogicalToPerMonitorDPIPhysicalPoint( hwnd, &pos );
+    pos = virtual_screen_to_root( pos.x, pos.y );
 
     if (NtUserGetKeyState( VK_LBUTTON ) & 0x8000) button = 1;
     else if (NtUserGetKeyState( VK_MBUTTON ) & 0x8000) button = 2;
-- 
2.46.0

