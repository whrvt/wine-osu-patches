From 52aaa9f9df9736fa0aa54af4f5d5e5c2bba1ec2c Mon Sep 17 00:00:00 2001
From: Mohamad Al-Jaf <mohamadaljaf@gmail.com>
Date: Wed, 12 Mar 2025 22:20:46 -0400
Subject: [PATCH] windows.system.profile.systemid/tests: Add
 ISystemIdentificationInfo::get_Source() tests.

---
 dlls/windows.system.profile.systemid/tests/systemid.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/dlls/windows.system.profile.systemid/tests/systemid.c b/dlls/windows.system.profile.systemid/tests/systemid.c
index ac518718414..35e50c1ed03 100644
--- a/dlls/windows.system.profile.systemid/tests/systemid.c
+++ b/dlls/windows.system.profile.systemid/tests/systemid.c
@@ -48,6 +48,7 @@ static void test_SystemIdentification_Statics(void)
     static const WCHAR *system_id_statics_name = L"Windows.System.Profile.SystemIdentification";
     ISystemIdentificationStatics *system_id_statics = (void *)0xdeadbeef;
     ISystemIdentificationInfo *system_id_info = (void *)0xdeadbeef;
+    SystemIdentificationSource system_id_source = 0xdeadbeef;
     IActivationFactory *factory = (void *)0xdeadbeef;
     HSTRING str = NULL;
     HRESULT hr;
@@ -78,6 +79,15 @@ static void test_SystemIdentification_Statics(void)
 
     check_interface( system_id_info, &IID_IAgileObject, FALSE );
 
+    hr = ISystemIdentificationInfo_get_Source( system_id_info, NULL );
+    todo_wine
+    ok( hr == E_INVALIDARG, "got hr %#lx.\n", hr );
+    hr = ISystemIdentificationInfo_get_Source( system_id_info, &system_id_source );
+    todo_wine
+    ok( hr == S_OK, "got hr %#lx.\n", hr );
+    todo_wine
+    ok( system_id_source == SystemIdentificationSource_Uefi, "ISystemIdentificationInfo_get_Source returned %u.\n", system_id_source );
+
     ref = ISystemIdentificationInfo_Release( system_id_info );
     ok( ref == 0, "got ref %ld.\n", ref );
     ref = ISystemIdentificationStatics_Release( system_id_statics );
-- 
GitLab

