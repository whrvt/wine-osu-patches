From 53a41198e809fceb2cdce1d1f3cbf96ed3d1f903 Mon Sep 17 00:00:00 2001
From: winebuild <wine@build.dev>
Date: Mon, 21 Jul 2025 03:08:33 +0200
Subject: [PATCH] loader: move NTsync logging after sync message

Fixes an issue in MangoHud where it would always pickup NTsync as the current sync due to
it being the first sync method mentioned in logs.
---
 dlls/ntdll/loader.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/dlls/ntdll/loader.c b/dlls/ntdll/loader.c
index 8c4b6018124..33a2ee43392 100644
--- a/dlls/ntdll/loader.c
+++ b/dlls/ntdll/loader.c
@@ -4707,8 +4707,6 @@ void loader_init( CONTEXT *context, void **entry )
             if (FIXME_ON(sync))
             {
                 NTSTATUS sync = __wine_get_sync_type();
-                if (sync < 0)
-                    MESSAGE("ntsync is explicitly disabled.\n");
                 switch (abs(sync))
                 {
                 case 1:
@@ -4724,6 +4722,8 @@ void loader_init( CONTEXT *context, void **entry )
                     MESSAGE("wineserver: using server-side synchronization.\n");
                     break;
                 }
+                if (sync < 0)
+                    MESSAGE("ntsync is explicitly disabled.\n");
             }
             if (FIXME_ON(winediag))
                 MESSAGE("winediag: this wine %s contains many experimental patches, please don't report bugs to winehq.org.\n", wine_get_version());
-- 
2.50.1

